<!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Security Scan Results</title>
                <style>
                    /* Styles for vulnerability display */
                    .vulnerability-item {
                        background-color: var(--vscode-editor-background);
                        padding: 15px;
                        border-radius: 4px;
                        border-left-width: 4px;
                        border-left-style: solid;
                        margin-bottom: 15px;
                    }

                    .vulnerability-item.high {
                        border-left-color: var(--high-severity);
                    }

                    .vulnerability-item.medium {
                        border-left-color: var(--medium-severity);
                    }

                    .vulnerability-item.low {
                        border-left-color: var(--low-severity);
                    }

                    /* Code snippet styling */
                    .code-snippet {
                        background-color: var(--vscode-editor-background);
                        padding: 10px;
                        border-radius: 4px;
                        overflow-x: auto;
                        margin: 8px 0;
                        font-family: 'Consolas', 'Monaco', monospace;
                    }

                    /* Title and badge styling */
                    .severity-badge {
                        font-size: 12px;
                        padding: 2px 8px;
                        border-radius: 12px;
                        font-weight: normal;
                        margin-right: 10px;
                    }

                    .severity-badge.high {
                        background-color: #dc3545;
                        color: white;
                    }

                    .severity-badge.medium {
                        background-color: #ffc107;
                        color: black;
                    }

                    .severity-badge.low {
                        background-color: #28a745;
                        color: white;
                    }

                    .title {
                        font-size: 16px;
                        flex: 1;
                    }

                    h3 {
                        display: flex;
                        align-items: center;
                        gap: 10px;
                        margin-top: 0;
                        margin-bottom: 15px;
                    }

                    /* Line number reference styling */
                    .line-ref {
                        font-family: 'Consolas', 'Monaco', monospace;
                        padding: 2px 6px;
                        background-color: var(--vscode-input-background);
                        border-radius: 3px;
                        display: inline-block;
                    }

                    /* Details grid styling */
                    .details-grid {
                        display: grid;
                        gap: 15px;
                    }

                    .detail-item {
                        padding: 10px;
                        background-color: var(--vscode-input-background);
                        border-radius: 4px;
                    }

                    .detail-label {
                        font-size: 12px;
                        text-transform: uppercase;
                        color: var(--vscode-descriptionForeground);
                        display: block;
                        margin-bottom: 5px;
                    }

                    /* Confidence bar styling */
                    .confidence-bar {
                        height: 20px;
                        background-color: var(--vscode-editor-background);
                        border-radius: 10px;
                        overflow: hidden;
                        position: relative;
                    }

                    .confidence-fill {
                        height: 100%;
                        background-color: #4a9eff;
                        transition: width 0.3s ease;
                    }

                    .confidence-text {
                        position: absolute;
                        right: 8px;
                        top: 50%;
                        transform: translateY(-50%);
                        font-size: 12px;
                        color: white;
                    }

                    /* Suggestion block styling */
                    .suggestion-block {
                        background-color: var(--vscode-editor-background);
                        border-left: 4px solid #4a9eff;
                        padding: 10px;
                        border-radius: 0 4px 4px 0;
                    }
                </style>
            </head>
            <body>
                <div class="container">
                    <h2>Security Scan Results</h2>
                    <p class="provider-info">Generated using AI-powered vulnerability scanning</p>
                    
            <div class="vulnerability-item high">
                <h3>
                    <span class="severity-badge high">High Severity</span>
                    <span class="title">SQL Injection Vulnerability: executeQuery</span>
                </h3>
                <div class="details-grid">
                    <div class="detail-item">
                        <span class="detail-label">Description</span>
                        <div class="description">The function directly interpolates user input into an SQL query without any sanitization or parameterization, making it vulnerable to SQL injection attacks.</div>
                    </div>

                    <div class="detail-item line-number">
                        <span class="detail-label">Line Number</span>
                        <div class="line-ref">2</div>
                    </div>


                    <div class="detail-item">
                        <span class="detail-label">Vulnerable Code</span>
                        <pre class="code-snippet"><code>1: function executeQuery(query: string) {
2:   return `SELECT * FROM users WHERE id = ${query}`;
3: }
4: 
5: function displayUserInput(input: string) {
6:   const element = document.createElement(&quot;div&quot;);</code></pre>
                    </div>

                    <div class="detail-item">
                        <span class="detail-label">Possible Remediation</span>
                        <div class="suggestion suggestion-block">
                            <div class="suggestion-content">Use parameterized queries or prepared statements to prevent SQL injection. Example:

```typescript
function executeQuery(query: string) {
  const sql = &#039;SELECT * FROM users WHERE id = ?&#039;;
  // Use a database library that supports parameterized queries
  database.execute(sql, [query]);
}
```</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Confidence Score</span>
                        <div class="confidence-bar">
                            <div class="confidence-fill" style="width: 90%"></div>
                            <span class="confidence-text">90.0%</span>
                        </div>
                    </div>
                </div>
            </div>
        
            <div class="vulnerability-item high">
                <h3>
                    <span class="severity-badge high">High Severity</span>
                    <span class="title">Cross-site Scripting (XSS) Vulnerability: displayUserInput</span>
                </h3>
                <div class="details-grid">
                    <div class="detail-item">
                        <span class="detail-label">Description</span>
                        <div class="description">The function sets `innerHTML` with user input directly, which can lead to XSS if the input is not properly sanitized.</div>
                    </div>

                    <div class="detail-item line-number">
                        <span class="detail-label">Line Number</span>
                        <div class="line-ref">6</div>
                    </div>


                    <div class="detail-item">
                        <span class="detail-label">Vulnerable Code</span>
                        <pre class="code-snippet"><code>4: 
5: function displayUserInput(input: string) {
6:   const element = document.createElement(&quot;div&quot;);
7:   element.innerHTML = input;
8:   document.body.appendChild(element);
9: }
10: </code></pre>
                    </div>

                    <div class="detail-item">
                        <span class="detail-label">Possible Remediation</span>
                        <div class="suggestion suggestion-block">
                            <div class="suggestion-content">Escape or sanitize user input before inserting it into the DOM. Example:

```typescript
function displayUserInput(input: string) {
  const element = document.createElement(&quot;div&quot;);
  element.textContent = input; // Use textContent to prevent XSS
  document.body.appendChild(element);
}
```</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Confidence Score</span>
                        <div class="confidence-bar">
                            <div class="confidence-fill" style="width: 90%"></div>
                            <span class="confidence-text">90.0%</span>
                        </div>
                    </div>
                </div>
            </div>
        
            <div class="vulnerability-item high">
                <h3>
                    <span class="severity-badge high">High Severity</span>
                    <span class="title">Command Injection Vulnerability: processCommand</span>
                </h3>
                <div class="details-grid">
                    <div class="detail-item">
                        <span class="detail-label">Description</span>
                        <div class="description">The function uses `exec` to run shell commands with user input, which can lead to command injection if the input is not properly validated.</div>
                    </div>

                    <div class="detail-item line-number">
                        <span class="detail-label">Line Number</span>
                        <div class="line-ref">11</div>
                    </div>


                    <div class="detail-item">
                        <span class="detail-label">Vulnerable Code</span>
                        <pre class="code-snippet"><code>9: }
10: 
11: function processCommand(cmd: string) {
12:   const exec = require(&quot;child_process&quot;).exec;
13:   exec(cmd, (error: any, stdout: any) =&gt; {
14:     console.log(stdout);
15:   });</code></pre>
                    </div>

                    <div class="detail-item">
                        <span class="detail-label">Possible Remediation</span>
                        <div class="suggestion suggestion-block">
                            <div class="suggestion-content">Validate and sanitize the input to ensure it does not contain malicious shell commands. Consider using `execFile` for safer execution. Example:

```typescript
function processCommand(cmd: string) {
  const execFile = require(&quot;child_process&quot;).execFile;
  execFile(cmd, (error: any, stdout: any) =&gt; {
    console.log(stdout);
  });
}
```</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Confidence Score</span>
                        <div class="confidence-bar">
                            <div class="confidence-fill" style="width: 90%"></div>
                            <span class="confidence-text">90.0%</span>
                        </div>
                    </div>
                </div>
            </div>
        
            <div class="vulnerability-item high">
                <h3>
                    <span class="severity-badge high">High Severity</span>
                    <span class="title">Cryptographic Failures Vulnerability: storePassword</span>
                </h3>
                <div class="details-grid">
                    <div class="detail-item">
                        <span class="detail-label">Description</span>
                        <div class="description">The function uses MD5 for hashing passwords, which is considered insecure due to its vulnerability to collision attacks.</div>
                    </div>

                    <div class="detail-item line-number">
                        <span class="detail-label">Line Number</span>
                        <div class="line-ref">16</div>
                    </div>


                    <div class="detail-item">
                        <span class="detail-label">Vulnerable Code</span>
                        <pre class="code-snippet"><code>14:     console.log(stdout);
15:   });
16: }
17: 
18: function storePassword(password: string) {
19:   const crypto = require(&quot;crypto&quot;);
20:   return crypto.createHash(&quot;md5&quot;).update(password).digest(&quot;hex&quot;);</code></pre>
                    </div>

                    <div class="detail-item">
                        <span class="detail-label">Possible Remediation</span>
                        <div class="suggestion suggestion-block">
                            <div class="suggestion-content">Use a stronger hashing algorithm like bcrypt or Argon2 for password hashing. Example:

```typescript
const bcrypt = require(&#039;bcrypt&#039;);
function storePassword(password: string) {
  const saltRounds = 10;
  return bcrypt.hashSync(password, saltRounds);
}
```</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Confidence Score</span>
                        <div class="confidence-bar">
                            <div class="confidence-fill" style="width: 90%"></div>
                            <span class="confidence-text">90.0%</span>
                        </div>
                    </div>
                </div>
            </div>
        
            <div class="vulnerability-item medium">
                <h3>
                    <span class="severity-badge medium">Medium Severity</span>
                    <span class="title">Race Condition Vulnerability: withdrawMoney</span>
                </h3>
                <div class="details-grid">
                    <div class="detail-item">
                        <span class="detail-label">Description</span>
                        <div class="description">The function checks the balance and then performs an asynchronous operation before deducting the amount, which can lead to race conditions if multiple withdrawals are attempted simultaneously.</div>
                    </div>

                    <div class="detail-item line-number">
                        <span class="detail-label">Line Number</span>
                        <div class="line-ref">25</div>
                    </div>


                    <div class="detail-item">
                        <span class="detail-label">Vulnerable Code</span>
                        <pre class="code-snippet"><code>23: function transferFunds(amount: number, toAccount: string) {
24:   if (amount &gt; 0) {
25:     return `Transferred ${amount} to ${toAccount}`;
26:   }
27: }
28: 
29: let balance = 100;</code></pre>
                    </div>

                    <div class="detail-item">
                        <span class="detail-label">Possible Remediation</span>
                        <div class="suggestion suggestion-block">
                            <div class="suggestion-content">Use locks or transactions to ensure atomicity of the balance check and deduction. Example:

```typescript
async function withdrawMoney(amount: number) {
  await lock.acquire();
  try {
    if (balance &gt;= amount) {
      balance -= amount;
      return amount;
    }
  } finally {
    lock.release();
  }
  return 0;
}
```</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Confidence Score</span>
                        <div class="confidence-bar">
                            <div class="confidence-fill" style="width: 70%"></div>
                            <span class="confidence-text">70.0%</span>
                        </div>
                    </div>
                </div>
            </div>
        
                </div>
            </body>
            </html>